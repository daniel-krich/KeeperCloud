"use strict";(self.webpackChunkKeeperNg=self.webpackChunkKeeperNg||[]).push([[693],{693:(L,I,i)=>{i.r(I),i.d(I,{ClientRepositoryShellModule:()=>A});var a=i(6895),d=i(9116),m=i(4017),b=i(8505),g=i(9300),O=i(4004),N=i(7446),F=i(8174),t=i(4650),U=i(9653);class f{constructor(e){this.store=e}resolve(e,o){return this.retrieveRepository(e.params.repositoryId)}retrieveRepository(e){return this.store.select((0,F.H_)(e)).pipe((0,b.b)(o=>{!o.repository&&"success"===o.status&&this.store.dispatch((0,N.lT)({repositoryId:e}))}),(0,g.h)(o=>!!o.repository&&"loading"!==o.status&&"pending"!==o.status),(0,O.U)(o=>!0))}}f.\u0275fac=function(e){return new(e||f)(t.LFG(U.yh))},f.\u0275prov=t.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"});var P=i(3900);class Y{constructor(e){this.id=e.id,this.name=e.name,this.description=e.description,this.createdDate=e.createdDate,this.overallFileCount=e.overallFileCount,this.overallRepositorySize=e.overallRepositorySize,this.allowAnonymousFileRead=e.allowAnonymousFileRead}}var p=i(7274),z=i(7579),s=i(4006),u=i(4859),h=i(4144),c=i(9549);function B(n,e){if(1&n&&(t.TgZ(0,"mat-error"),t._uU(1,"Please enter "),t.TgZ(2,"b"),t._uU(3),t.qZA(),t._uU(4,"."),t.qZA()),2&n){const o=t.oxw();t.xp6(3),t.hij('"',o.repositoryNameValidation,'"')}}function Q(n,e){if(1&n&&(t.TgZ(0,"mat-error",13),t._uU(1),t.qZA()),2&n){const o=e.ngIf;t.xp6(1),t.Oqu(o)}}class M{constructor(e,o){this.dialogRef=e,this.repositoryNameValidation=o,this.repositoryName="",this.errorMessage$=new z.x}onDelete(){this.repositoryName===this.repositoryNameValidation?this.dialogRef.close(!0):this.errorMessage$.next("Repository names doesn't match")}onCancel(){this.dialogRef.close(!1)}}function j(n,e){1&n&&(t.TgZ(0,"mat-error"),t._uU(1,"Please enter a valid repository name."),t.qZA())}function K(n,e){1&n&&(t.TgZ(0,"mat-error"),t._uU(1,"Please enter a valid repository description."),t.qZA())}M.\u0275fac=function(e){return new(e||M)(t.Y36(p.so),t.Y36(p.WI))},M.\u0275cmp=t.Xpm({type:M,selectors:[["app-repository-delete-dialog"]],decls:26,vars:7,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"d-flex","flex-column","p-2",3,"ngSubmit"],["deleteRepoForm","ngForm"],[1,"form-row"],["floatLabel","always",1,"form-group","col-12","p-2"],["matInput","","type","text","name","repository_name","required","",3,"ngModel","ngModelChange"],["repositoryNameField","ngModel"],[4,"ngIf"],["class","mb-3 text-center",4,"ngIf"],[1,"d-flex","justify-content-around"],["mat-flat-button","","type","button",3,"click"],["mat-raised-button","","color","accent","type","submit",3,"disabled"],[1,"mb-3","text-center"]],template:function(e,o){if(1&e&&(t.TgZ(0,"h1",0),t._uU(1,"Confirm repository deletion"),t.qZA(),t.TgZ(2,"div",1)(3,"p"),t._uU(4,'Please enter "'),t.TgZ(5,"b"),t._uU(6),t.qZA(),t._uU(7,'" to confirm the repository deletion.'),t.qZA(),t.TgZ(8,"p"),t._uU(9,"Keep in mind that repository deletion will result in also all the files associated with the repository in permanent deletion."),t.qZA()(),t.TgZ(10,"form",2,3),t.NdJ("ngSubmit",function(){return o.onDelete()}),t.TgZ(12,"div",4)(13,"mat-form-field",5)(14,"mat-label"),t._uU(15,"Repository name confirm"),t.qZA(),t.TgZ(16,"input",6,7),t.NdJ("ngModelChange",function(l){return o.repositoryName=l}),t.qZA(),t.YNc(18,B,5,1,"mat-error",8),t.qZA()(),t.YNc(19,Q,2,1,"mat-error",9),t.ALo(20,"async"),t.TgZ(21,"div",10)(22,"button",11),t.NdJ("click",function(){return o.onCancel()}),t._uU(23," Cancel "),t.qZA(),t.TgZ(24,"button",12),t._uU(25," Delete "),t.qZA()()()),2&e){const r=t.MAs(11),l=t.MAs(17);t.xp6(6),t.Oqu(o.repositoryNameValidation),t.xp6(10),t.Q6J("ngModel",o.repositoryName),t.xp6(2),t.Q6J("ngIf",l.invalid),t.xp6(1),t.Q6J("ngIf",t.lcZ(20,5,o.errorMessage$)),t.xp6(5),t.Q6J("disabled",!r.valid)}},dependencies:[a.O5,s._Y,s.Fj,s.JJ,s.JL,s.Q7,s.On,s.F,u.lW,p.uh,p.xY,h.Nt,c.KE,c.hX,c.TO,a.Ov],encapsulation:2,changeDetection:0});class T{constructor(e,o){this.dialogRef=e,this.repositoryModel=o}onSave(){this.dialogRef.close(!0)}onCancel(){this.dialogRef.close(!1)}}T.\u0275fac=function(e){return new(e||T)(t.Y36(p.so),t.Y36(p.WI))},T.\u0275cmp=t.Xpm({type:T,selectors:[["app-repository-edit-dialog"]],decls:21,vars:5,consts:[[1,"d-flex","flex-column","p-2",3,"ngSubmit"],["editRepoForm","ngForm"],[1,"form-row"],["floatLabel","always",1,"form-group","col-12","p-2"],["matInput","","type","text","name","repository_name","maxlength","60","required","",3,"ngModel","ngModelChange"],["repositoryNameField","ngModel"],[4,"ngIf"],["matInput","","placeholder","Repository description","type","text","name","repository_description","maxlength","256","required","",3,"ngModel","ngModelChange"],["repositoryDescriptionField","ngModel"],[1,"d-flex","justify-content-around"],["mat-flat-button","","type","button",3,"click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"]],template:function(e,o){if(1&e&&(t.TgZ(0,"form",0,1),t.NdJ("ngSubmit",function(){return o.onSave()}),t.TgZ(2,"div",2)(3,"mat-form-field",3)(4,"mat-label"),t._uU(5,"Repository name"),t.qZA(),t.TgZ(6,"input",4,5),t.NdJ("ngModelChange",function(l){return o.repositoryModel.name=l}),t.qZA(),t.YNc(8,j,2,0,"mat-error",6),t.qZA()(),t.TgZ(9,"div",2)(10,"mat-form-field",3)(11,"mat-label"),t._uU(12,"Repository description"),t.qZA(),t.TgZ(13,"textarea",7,8),t.NdJ("ngModelChange",function(l){return o.repositoryModel.description=l}),t.qZA(),t.YNc(15,K,2,0,"mat-error",6),t.qZA()(),t.TgZ(16,"div",9)(17,"button",10),t.NdJ("click",function(){return o.onCancel()}),t._uU(18," Cancel "),t.qZA(),t.TgZ(19,"button",11),t._uU(20," Save "),t.qZA()()()),2&e){const r=t.MAs(1),l=t.MAs(7),y=t.MAs(14);t.xp6(6),t.Q6J("ngModel",o.repositoryModel.name),t.xp6(2),t.Q6J("ngIf",l.invalid),t.xp6(5),t.Q6J("ngModel",o.repositoryModel.description),t.xp6(2),t.Q6J("ngIf",y.invalid),t.xp6(4),t.Q6J("disabled",!r.valid)}},dependencies:[a.O5,s._Y,s.Fj,s.JJ,s.JL,s.Q7,s.nD,s.On,s.F,u.lW,h.Nt,c.KE,c.hX,c.TO],encapsulation:2,changeDetection:0});var E=i(7392),W=i(4345);class x{constructor(){this.repositoryEditOpen=new t.vpe,this.repositoryRemove=new t.vpe}}x.\u0275fac=function(e){return new(e||x)},x.\u0275cmp=t.Xpm({type:x,selectors:[["app-repository-info"]],inputs:{repository:"repository"},outputs:{repositoryEditOpen:"repositoryEditOpen",repositoryRemove:"repositoryRemove"},decls:18,vars:9,consts:[[1,"card","position-relative"],[1,"card-body","p-4"],[1,"card-title","mb-4"],[1,"card-text","mb-4"],[1,"card-text"],[1,"d-flex","position-absolute","top-0","end-0"],["mat-icon-button","",1,"d-flex","justify-content-center","align-items-center",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h2",2),t._uU(3),t.qZA(),t.TgZ(4,"h6",3),t._uU(5),t.qZA(),t.TgZ(6,"p",4)(7,"small"),t._uU(8),t.ALo(9,"convertByteSizeToString"),t.ALo(10,"date"),t.qZA()()(),t.TgZ(11,"div",5)(12,"button",6),t.NdJ("click",function(){return o.repositoryEditOpen.emit()}),t.TgZ(13,"mat-icon"),t._uU(14,"edit"),t.qZA()(),t.TgZ(15,"button",6),t.NdJ("click",function(){return o.repositoryRemove.emit()}),t.TgZ(16,"mat-icon"),t._uU(17,"cancel"),t.qZA()()()()),2&e&&(t.xp6(3),t.Oqu(o.repository.name),t.xp6(2),t.Oqu(o.repository.description),t.xp6(3),t.lnq("",o.repository.overallFileCount," files, ",t.lcZ(9,5,o.repository.overallRepositorySize),", Created on ",t.lcZ(10,7,o.repository.createdDate),""))},dependencies:[E.Hw,u.RK,a.uU,W.S],styles:[".card[_ngcontent-%COMP%]{background-color:var(--primary-color);color:#fff;border-radius:0;border:none;border-bottom:rgba(33,33,33,.1450980392) solid 1px}"],changeDetection:0});var S=i(3848);const $=function(){return{exact:!0}};function X(n,e){if(1&n&&(t.TgZ(0,"a",7,8),t._uU(2),t.qZA()),2&n){const o=e.$implicit,r=t.MAs(1);t.Q6J("routerLink",o.path)("routerLinkActiveOptions",t.DdM(4,$))("active",r.isActive),t.xp6(2),t.Oqu(o.label)}}function H(n,e){if(1&n){const o=t.EpF();t.ynx(0),t.TgZ(1,"app-repository-info",2),t.NdJ("repositoryEditOpen",function(){const y=t.CHM(o).ngIf,J=t.oxw();return t.KtG(J.onRepoEditOpen(y))})("repositoryRemove",function(){const y=t.CHM(o).ngIf,J=t.oxw();return t.KtG(J.onRepoRemove(y))}),t.qZA(),t.TgZ(2,"div",3)(3,"nav",4),t.YNc(4,X,3,5,"a",5),t._UZ(5,"mat-tab-nav-panel",null,6),t.qZA()(),t._UZ(7,"router-outlet"),t.BQk()}if(2&n){const o=e.ngIf,r=t.MAs(6),l=t.oxw();t.xp6(1),t.Q6J("repository",o),t.xp6(2),t.Q6J("tabPanel",r),t.xp6(1),t.Q6J("ngForOf",l.links)}}class D{constructor(e,o,r){this.store=e,this.dialog=o,this.route=r,this.links=[{path:"./",label:"Repository files"},{path:"./manage-access",label:"Manage access"},{path:"./activity-log",label:"Activity log"}],this.repoId$=this.route.paramMap.pipe((0,O.U)(l=>l.get("repositoryId"))),this.repository$=this.repoId$.pipe((0,P.w)(l=>this.store.select((0,F.cc)(l)).pipe((0,g.h)(y=>null!==y))))}onRepoEditOpen(e){const o=new Y(e);this.dialog.open(T,{data:o,width:"100%",maxWidth:"500px",enterAnimationDuration:"300",exitAnimationDuration:"300"}).afterClosed().subscribe(l=>{l&&this.store.dispatch((0,N.U1)({repositoryId:e.id,repositoryUpdate:{name:o.name,description:o.description}}))})}onRepoRemove(e){this.dialog.open(M,{maxWidth:"400px",data:e.name}).afterClosed().subscribe(r=>{r&&this.store.dispatch((0,N.uY)({repository:e}))})}}D.\u0275fac=function(e){return new(e||D)(t.Y36(U.yh),t.Y36(p.uw),t.Y36(d.gz))},D.\u0275cmp=t.Xpm({type:D,selectors:[["ng-component"]],decls:3,vars:3,consts:[[1,"fix-height"],[4,"ngIf"],[3,"repository","repositoryEditOpen","repositoryRemove"],[1,"d-flex","bg-light"],["mat-tab-nav-bar","",3,"tabPanel"],["mat-tab-link","","routerLinkActive","",3,"routerLink","routerLinkActiveOptions","active",4,"ngFor","ngForOf"],["tabPanel",""],["mat-tab-link","","routerLinkActive","",3,"routerLink","routerLinkActiveOptions","active"],["linkActive","routerLinkActive"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0),t.YNc(1,H,8,3,"ng-container",1),t.ALo(2,"async"),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,o.repository$)))},dependencies:[a.sg,a.O5,d.lC,d.rH,d.Od,x,S.BU,S.sW,S.Nj,a.Ov],styles:[".fix-height[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column}"],changeDetection:0});const V=[{path:":repositoryId",component:D,children:[{path:"",loadChildren:()=>Promise.all([i.e(255),i.e(758),i.e(973)]).then(i.bind(i,9973)).then(n=>n.ClientRepositoryFilesModule),canActivate:[m.k],pathMatch:"full",title:"Client / Files"},{path:"manage-access",loadChildren:()=>Promise.all([i.e(546),i.e(255),i.e(758),i.e(514),i.e(190)]).then(i.bind(i,8190)).then(n=>n.ClientRepositoryManageAccessModule),canActivate:[m.k],title:"Client / Manage access"},{path:"activity-log",loadChildren:()=>Promise.all([i.e(758),i.e(514),i.e(218)]).then(i.bind(i,6218)).then(n=>n.ClientRepositoryActivityLogModule),canActivate:[m.k],title:"Client / Activity log"}],resolve:[f]},{path:"",redirectTo:"/client",pathMatch:"full"}];class v{}v.\u0275fac=function(e){return new(e||v)},v.\u0275mod=t.oAB({type:v}),v.\u0275inj=t.cJS({imports:[d.Bz.forChild(V),d.Bz]});class R{}R.\u0275fac=function(e){return new(e||R)},R.\u0275mod=t.oAB({type:R}),R.\u0275inj=t.cJS({imports:[a.ez,s.u5,u.ot,p.Is,h.c,c.lN,s.u5,h.c,c.lN,u.ot,p.Is]});class C{}C.\u0275fac=function(e){return new(e||C)},C.\u0275mod=t.oAB({type:C}),C.\u0275inj=t.cJS({imports:[a.ez,s.u5,u.ot,p.Is,h.c,c.lN,s.u5,h.c,c.lN,u.ot,p.Is]});var G=i(5568);class Z{}Z.\u0275fac=function(e){return new(e||Z)},Z.\u0275mod=t.oAB({type:Z}),Z.\u0275inj=t.cJS({imports:[a.ez,E.Ps,u.ot,G.I]});class A{}A.\u0275fac=function(e){return new(e||A)},A.\u0275mod=t.oAB({type:A}),A.\u0275inj=t.cJS({imports:[a.ez,d.Bz,v,R,C,Z,S.Nh,p.Is]})},4345:(L,I,i)=>{i.d(I,{S:()=>m});var a=i(6650),d=i(4650);class m{transform(g){return(0,a.Z)(g)}}m.\u0275fac=function(g){return new(g||m)},m.\u0275pipe=d.Yjl({name:"convertByteSizeToString",type:m,pure:!0})}}]);